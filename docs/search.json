[
  {
    "objectID": "day2.html",
    "href": "day2.html",
    "title": "Day 2",
    "section": "",
    "text": "Yesterday we covered:\n\nHow to use Unix.\nHow to get onto HAWK.\nHow to fetch the Github repository and download the resources.\nHow to execute the scrnaseq nextflow pipeline on Hawk.\n\n\n\n\n\n\nThe output from the nextflow execution run is stored under results/cellranger_count_1k_mouse_kidney_CNIK_3pv3\nLogin to your Hawk account and access the folder:\n\ncd /scratch/c.123456/scrnaseq-course/scrnaseq/results\n\ncd cellranger_count_1k_mouse_kidney_CNIK_3pv3\n\n\n\n\nYou can skip this step if you are working on RStudio Server.\nOnce the counts are generated using nextflow pipeline, download the data onto your personal computer.\nFor this, you will need to use Filezilla to copy the files from remote onto your local machine.\nFollow the steps below:\n\n\nType in the Host: hawklogin.cf.ac.uk\nUsername: \nPassword: \nPort: 22\n\n\nClick on Quickconnect\nNavigate to the folder scrnaseq-course/scrnaseq/results\nCreate a folder on your local machine, called scrnaseq-nextflow.\nCreate 4 folders within scrnaseq-nextflow folder:\n\nbin\ninput\noutput\nresources\n\nNow, Drag and Drop the files from the results folder in the remote server to your input folder within scrnaseq-nextflow folder on your local machine.\nOnce the files are copied, these should be visible on your local machine under input folder.\n\n\n\n\n\n\nOnce the counts have been downloaded into the input folder on your local machine, Start RStudio on Mac/Windows.\n\n\n\nClick on New File –&gt; R Markdown...\n\n\n\nThis is will open an Untiltled file on the top-left hand side.\n\n\n\nDelete lines from 7 until 29 except first 5-6 lines.\n\n\n\n\n\nCopy the line in your markdown document:\n\n\n\nCode\n# load libraries\nlibrary(Seurat)\n\n\nLoading required package: SeuratObject\n\n\nLoading required package: sp\n\n\n'SeuratObject' was built under R 4.5.0 but the current version is\n4.5.2; it is recomended that you reinstall 'SeuratObject' as the ABI\nfor R may have changed\n\n\n\nAttaching package: 'SeuratObject'\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, t\n\n\n\nPress the green arrow key on line 7 which says Run Current Chunk to load the Seurat library.\n\n\n\n\n\n\nWe start by reading in the data. The Read10X() function reads in the output of the cellranger pipeline from 10X, returning a unique molecular identified (UMI) count matrix.\nThe values in this matrix represent the number of molecules for each feature (i.e. gene; row) that are detected in each cell (column).\n\n# Load the 1k mouse kidney dataset\ndat2 &lt;- Read10X(data.dir = \"input/filtered_feature_bc_matrix/\")\n\nWe next use the count matrix to create a Seurat object.\n\n# Initialize the Seurat object with the raw (non-normalized data).\ndat2Obj &lt;- CreateSeuratObject(counts = dat2, project = \"1KmouseKidney\", min.cells = 3, min.features = 200)\n\ndat2Obj\n\n\n\n\nSeurat allows you to easily explore QC metrics and filter cells based on any user-defined criteria.\nThese includes:\n\nThe number of unique genes detected in each cell.\n\nLow-quality cells or empty droplets will often have very few genes\nCell doublets or multiplets may exhibit an aberrantly high gene count\n\nThe percentage of reads that map to the mitochondrial genome.\n\nLow-quality / dying cells often exhibit extensive mitochondrial contamination\nWe calculate mitochondrial QC metrics with the PercentageFeatureSet() function\nWe use the set of all genes starting with MT- or mt- as a set of mitochondrial genes\n\n\n\n# The [[ operator can add columns to object metadata.\ndat2Obj[[\"percent.mt\"]] &lt;- PercentageFeatureSet(dat2Obj, pattern = \"^mt-\")\n\nTo visualize QC metrics, we use VlnPlot() function.\n\n# Visualize QC metrics as a violin plot\nVlnPlot(dat2Obj, features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mt\"), ncol = 3)"
  },
  {
    "objectID": "day2.html#recap-from-day-1",
    "href": "day2.html#recap-from-day-1",
    "title": "Day 2",
    "section": "",
    "text": "Yesterday we covered:\n\nHow to use Unix.\nHow to get onto HAWK.\nHow to fetch the Github repository and download the resources.\nHow to execute the scrnaseq nextflow pipeline on Hawk."
  },
  {
    "objectID": "day2.html#outputs-from-the-nextflow-pipeline",
    "href": "day2.html#outputs-from-the-nextflow-pipeline",
    "title": "Day 2",
    "section": "",
    "text": "The output from the nextflow execution run is stored under results/cellranger_count_1k_mouse_kidney_CNIK_3pv3\nLogin to your Hawk account and access the folder:\n\ncd /scratch/c.123456/scrnaseq-course/scrnaseq/results\n\ncd cellranger_count_1k_mouse_kidney_CNIK_3pv3"
  },
  {
    "objectID": "day2.html#downloading-data-for-analysis-in-seurat-for-analysis-on-rstudio-on-local-system",
    "href": "day2.html#downloading-data-for-analysis-in-seurat-for-analysis-on-rstudio-on-local-system",
    "title": "Day 2",
    "section": "",
    "text": "You can skip this step if you are working on RStudio Server.\nOnce the counts are generated using nextflow pipeline, download the data onto your personal computer.\nFor this, you will need to use Filezilla to copy the files from remote onto your local machine.\nFollow the steps below:\n\n\nType in the Host: hawklogin.cf.ac.uk\nUsername: \nPassword: \nPort: 22\n\n\nClick on Quickconnect\nNavigate to the folder scrnaseq-course/scrnaseq/results\nCreate a folder on your local machine, called scrnaseq-nextflow.\nCreate 4 folders within scrnaseq-nextflow folder:\n\nbin\ninput\noutput\nresources\n\nNow, Drag and Drop the files from the results folder in the remote server to your input folder within scrnaseq-nextflow folder on your local machine.\nOnce the files are copied, these should be visible on your local machine under input folder."
  },
  {
    "objectID": "day2.html#processing-scrnaseq-data-1k_mouse_kidney_cnik_3pv3-in-seurat",
    "href": "day2.html#processing-scrnaseq-data-1k_mouse_kidney_cnik_3pv3-in-seurat",
    "title": "Day 2",
    "section": "",
    "text": "Once the counts have been downloaded into the input folder on your local machine, Start RStudio on Mac/Windows.\n\n\n\nClick on New File –&gt; R Markdown...\n\n\n\nThis is will open an Untiltled file on the top-left hand side.\n\n\n\nDelete lines from 7 until 29 except first 5-6 lines.\n\n\n\n\n\nCopy the line in your markdown document:\n\n\n\nCode\n# load libraries\nlibrary(Seurat)\n\n\nLoading required package: SeuratObject\n\n\nLoading required package: sp\n\n\n'SeuratObject' was built under R 4.5.0 but the current version is\n4.5.2; it is recomended that you reinstall 'SeuratObject' as the ABI\nfor R may have changed\n\n\n\nAttaching package: 'SeuratObject'\n\n\nThe following objects are masked from 'package:base':\n\n    intersect, t\n\n\n\nPress the green arrow key on line 7 which says Run Current Chunk to load the Seurat library.\n\n\n\n\n\n\nWe start by reading in the data. The Read10X() function reads in the output of the cellranger pipeline from 10X, returning a unique molecular identified (UMI) count matrix.\nThe values in this matrix represent the number of molecules for each feature (i.e. gene; row) that are detected in each cell (column).\n\n# Load the 1k mouse kidney dataset\ndat2 &lt;- Read10X(data.dir = \"input/filtered_feature_bc_matrix/\")\n\nWe next use the count matrix to create a Seurat object.\n\n# Initialize the Seurat object with the raw (non-normalized data).\ndat2Obj &lt;- CreateSeuratObject(counts = dat2, project = \"1KmouseKidney\", min.cells = 3, min.features = 200)\n\ndat2Obj\n\n\n\n\nSeurat allows you to easily explore QC metrics and filter cells based on any user-defined criteria.\nThese includes:\n\nThe number of unique genes detected in each cell.\n\nLow-quality cells or empty droplets will often have very few genes\nCell doublets or multiplets may exhibit an aberrantly high gene count\n\nThe percentage of reads that map to the mitochondrial genome.\n\nLow-quality / dying cells often exhibit extensive mitochondrial contamination\nWe calculate mitochondrial QC metrics with the PercentageFeatureSet() function\nWe use the set of all genes starting with MT- or mt- as a set of mitochondrial genes\n\n\n\n# The [[ operator can add columns to object metadata.\ndat2Obj[[\"percent.mt\"]] &lt;- PercentageFeatureSet(dat2Obj, pattern = \"^mt-\")\n\nTo visualize QC metrics, we use VlnPlot() function.\n\n# Visualize QC metrics as a violin plot\nVlnPlot(dat2Obj, features = c(\"nFeature_RNA\", \"nCount_RNA\", \"percent.mt\"), ncol = 3)"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "scrnaseqcourse",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites.\n1 + 1\n\n[1] 2"
  },
  {
    "objectID": "index.html#what-you-will-learn-on-this-course",
    "href": "index.html#what-you-will-learn-on-this-course",
    "title": "scrnaseqcourse",
    "section": "What you will learn on this course:",
    "text": "What you will learn on this course:\n\nBasic Unix commands\nWorking on HPC\nDownloading scrnaseq datasets and genome files.\nSetting up directory for the data processing and analysis.\nHow to run Nextflow pipeline on HPCs.\nHow to process 10x cellranger pipeline.\nHow to process and analyse scrnaseq count data in R.\nHow to visualise the analysed data and perform additional downstream analysis."
  },
  {
    "objectID": "index.html#introduction-to-single-cell-rna-seq",
    "href": "index.html#introduction-to-single-cell-rna-seq",
    "title": "scrnaseqcourse",
    "section": "Introduction to Single-Cell RNA-seq",
    "text": "Introduction to Single-Cell RNA-seq\n\nRNA-seq allows profiling the transcripts in a sample in an efficient and cost-effective way.\nPart of its success is due to the fact that RNA-seq allows for an unbiased sampling of all transcripts in a sample, rather than being limited to a pre-determined set of transcripts (as in microarrays or RT-qPCR).\nTypically, RNA-seq has been used in samples composed of a mixture of cells, referred to as bulk RNA-seq, and has many applications.\nFor example, it can be used to characterise expression signatures between tissues in healthy/diseased, wild-type/mutant or control/treated samples.\nHowever, with bulk RNA-seq we can only estimate the average expression level for each gene across a population of cells, without regard for the heterogeneity in gene expression across individual cells of that sample.\n\n\n\nUnlike with the bulk approach, with scRNA-seq we can estimate a distribution of expression levels for each gene across a population of cells.\nThis allows us to answer new biological questions where cell-specific changes in the transcriptome are important. For example discovering new or rare cell types, identifying differential cell composition between healthy/diseased tissues or understanding cell differentiation during development."
  },
  {
    "objectID": "index.html#sample-preparation-protocols",
    "href": "index.html#sample-preparation-protocols",
    "title": "scrnaseqcourse",
    "section": "Sample Preparation Protocols",
    "text": "Sample Preparation Protocols\nBroadly speaking, a typical scRNA-seq protocol consists of the following steps (illustrated in the figure below):\n\nTissue dissection and cell dissociating to obtain a suspension of cells.\nOptionally cells may be selected\nCapture single cells into individual reaction containers (e.g. wells or oil droplets).\nExtracting the RNA from each cell.\nReverse-transcribing the RNA to more stable cDNA.\nAmplifying the cDNA (either by in vitro transcription or by PCR).\nPreparing the sequencing library with adequate molecular adapters.\nSequencing, usually with paired-end Illumina protocols.\nProcessing the raw data to obtain a count matrix of genes-by-cells\nCarrying several downstream analysis (the focus of this course)."
  },
  {
    "objectID": "index.html#unix-configuration",
    "href": "index.html#unix-configuration",
    "title": "scrnaseqcourse",
    "section": "Unix: Configuration",
    "text": "Unix: Configuration\n\nUnix: Hardware\n\nHardware: the physical components (the bits you can see when you take the back off a computer.\nCPU (central processing unit): the computer chip performing the calculations.\n\nHard drive: saved storage – your saved files.\nRAM (random access memory): like the hard drive, it stores information. Access (reading this information) is faster than the hard drive, although information is only present whilst the compute is powered on, i.e. this is memory space.\n\n\n\n\nUnix: Kernel\n\nThe kernel sits between the command line and the hardware.\n\nWhen you type a command line to the screen and hit “enter,” the kernel executes the command, allocating the appropriate time and memory to the task.\n\n\n\nUnix: Commands\n\nthe commands are the bread-and-butter functions common to all Linux installations and are part of the core (minimal) install.\nthey perform core processes such as file and job manipulations (read, write, delete files/jobs).\n\n\n\nUnix: Programs\n\nOther programs work identically to the core commands.\nThey are different because they generally perform specialised functions, for example, mapping next-generation sequence to a genome assembly."
  },
  {
    "objectID": "index.html#basic-unix-graphical-user-interface-gui-command-lineshell",
    "href": "index.html#basic-unix-graphical-user-interface-gui-command-lineshell",
    "title": "scrnaseqcourse",
    "section": "Basic Unix: Graphical User Interface (GUI) & Command Line/Shell",
    "text": "Basic Unix: Graphical User Interface (GUI) & Command Line/Shell\n\nAll Windows/Mac/Linux PC’s use a GUI to allow users to easily navigate and use the PC.\nThe GUI is common to Window/Mac/Linux.\n\nThe interface permits you to access files and run commands/programs by clicking icon/apps, drag-and-drop.\n\nThis is a shell. We can use this to type commands etc.\n\nIn simple terms, the window on the computer into which you type a command, is called the shell"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  }
]